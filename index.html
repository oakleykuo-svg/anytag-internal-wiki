<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAIWAN AnyTag & AnyCreator Support Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- æ›´æ–° Font Awesome ç‰ˆæœ¬è‡³ 6.5.1 ä»¥æ”¯æ´ Threads åœ–ç¤º -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            /* --- ä¸»è¦–è¦ºå®šç¾© --- */
            --brand-red: #E14F4B;
            --sidebar-bg: #091632; 
            --sidebar-text: #a0a0a0;
            --sidebar-hover: #1c2b4a;
            --sidebar-active: var(--brand-red);
            
            --main-bg: #f4f4f9;
            --card-bg: #ffffff;
            --text-primary: #222222;
            --text-secondary: #666666;
            
            --shadow-sm: 0 2px 4px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 6px 12px -2px rgb(0 0 0 / 0.1);
            --radius: 12px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--main-bg);
            color: var(--text-primary);
            display: flex;
            height: 100vh;
            overflow: hidden;
            
            background: 
                linear-gradient(135deg, rgba(9, 22, 50, 0.03) 25%, transparent 25%) -20px 0,
                linear-gradient(225deg, rgba(9, 22, 50, 0.03) 25%, transparent 25%) -20px 0,
                linear-gradient(315deg, rgba(9, 22, 50, 0.03) 25%, transparent 25%),
                linear-gradient(45deg, rgba(9, 22, 50, 0.03) 25%, transparent 25%);
            background-size: 60px 60px;
            background-color: var(--main-bg);
            animation: techFlow 10s linear infinite;
        }

        @keyframes techFlow {
            0% { background-position: 0 0; }
            100% { background-position: 60px 60px; }
        }

        /* --- å´é‚Šå°èˆªæ¬„ --- */
        .sidebar { width: 280px; background-color: var(--sidebar-bg); display: flex; flex-direction: column; padding: 24px 16px; flex-shrink: 0; border-right: 1px solid rgba(255,255,255,0.05); z-index: 10; overflow-y: auto; }
        .brand { color: #fff; font-size: 18px; font-weight: 700; display: flex; align-items: center; gap: 10px; margin-bottom: 40px; padding-left: 8px; line-height: 1.4; }
        .brand span { color: var(--brand-red); font-size: 24px; line-height: 0; }
        .nav-group { margin-bottom: 28px; }
        .nav-title { font-size: 11px; text-transform: uppercase; color: #889bb3; font-weight: 700; padding-left: 12px; margin-bottom: 10px; letter-spacing: 1.2px; }
        
        .nav-item { padding: 12px 14px; color: #bdcbe0; cursor: pointer; border-radius: 8px; font-size: 14px; font-weight: 500; display: flex; align-items: center; gap: 12px; transition: all 0.2s ease; margin-bottom: 6px; border-left: 3px solid transparent; }
        .nav-item:hover { background-color: var(--sidebar-hover); color: #fff; }
        .nav-item.active { background-color: rgba(225, 79, 75, 0.15); color: var(--brand-red); border-left: 3px solid var(--brand-red); }
        .nav-item.active i { color: var(--brand-red); }

        /* å­é¸å–®æ¨£å¼ */
        .submenu { 
            padding-left: 20px; display: none; overflow: hidden; transition: max-height 0.3s ease-out; 
        }
        .submenu.open { display: block; }
        .submenu-item {
            padding: 8px 14px; color: #889bb3; cursor: pointer; border-radius: 8px; font-size: 13px;
            display: flex; align-items: center; gap: 10px; margin-bottom: 4px; border-left: 2px solid transparent;
        }
        .submenu-item:hover { color: #fff; background-color: rgba(255,255,255,0.05); }
        .submenu-item.active { color: var(--brand-red); border-left: 2px solid var(--brand-red); background-color: rgba(225, 79, 75, 0.1); }
        .nav-expand-icon { margin-left: auto; font-size: 10px; transition: transform 0.3s; }
        .nav-item.expanded .nav-expand-icon { transform: rotate(90deg); }


        /* --- ä¸»å…§å®¹å€ --- */
        .main { flex: 1; overflow-y: auto; padding: 40px; position: relative; z-index: 5; background: rgba(244, 244, 249, 0.8); }
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .page-title h1 { font-size: 32px; font-weight: 800; color: #000; letter-spacing: -0.5px; }
        .page-title p { color: var(--text-secondary); margin-top: 8px; font-size: 15px; }

        .search-box { position: relative; width: 320px; }
        .search-box input { width: 100%; padding: 14px 20px; padding-left: 44px; border-radius: 50px; border: 2px solid transparent; font-size: 14px; background: #fff; box-shadow: var(--shadow-sm); transition: all 0.2s; }
        .search-box input:focus { border-color: var(--brand-red); box-shadow: 0 0 0 4px rgba(225, 79, 75, 0.1); }
        .search-icon { position: absolute; left: 16px; top: 14px; opacity: 0.4; }

        /* --- å…§å®¹å€å¡Šèˆ‡ Grid --- */
        .section { display: none; animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
        .section.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
        @media (max-width: 1200px) { .grid-4 { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { .grid-4 { grid-template-columns: 1fr; } }

        /* --- åˆ†æµé ç±¤ (Tabs) æ¨£å¼ --- */
        .tabs-container { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; align-items: center;}
        .tab-btn { 
            padding: 8px 20px; border-radius: 20px; border: 1px solid #e2e8f0; 
            background: #fff; color: #64748b; cursor: pointer; font-size: 14px; font-weight: 600;
            transition: all 0.2s ease;
        }
        .tab-btn:hover { background: #f8fafc; color: var(--brand-red); border-color: rgba(225, 79, 75, 0.3); }
        .tab-btn.active { 
            background: var(--brand-red); color: #fff; border-color: var(--brand-red); 
            box-shadow: 0 4px 10px rgba(225, 79, 75, 0.2);
        }

        /* --- ç¯©é¸å™¨ä¸‹æ‹‰é¸å–®æ¨£å¼ --- */
        .filter-select {
            padding: 8px 14px; border-radius: 20px; border: 1px solid #e2e8f0;
            background: #fff; color: #64748b; font-size: 14px; font-weight: 600;
            cursor: pointer; outline: none; margin-left: 5px;
        }
        .filter-select:focus { border-color: var(--brand-red); color: #333; }

        /* --- å¡ç‰‡æ¨£å¼ --- */
        .card { background: var(--card-bg); padding: 24px; border-radius: var(--radius); box-shadow: var(--shadow-sm); transition: all 0.3s ease; border: 1px solid rgba(0,0,0,0.05); position: relative; overflow: hidden; display: flex; flex-direction: column; height: 100%; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 12px 24px rgba(9, 22, 50, 0.15); border-color: rgba(9, 22, 50, 0.1); }
        .card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 3px; background: var(--brand-red); opacity: 0; transition: opacity 0.3s; }
        .card:hover::before { opacity: 1; }
        
        .card-icon { width: 48px; height: 48px; background: rgba(225, 79, 75, 0.1); color: var(--brand-red); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; margin-bottom: 16px; }
        .card h3 { font-size: 18px; font-weight: 700; margin-bottom: 10px; color: #000; }
        .card p { font-size: 14px; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; flex-grow: 1; }
        
        /* æŒ‰éˆ•æ¨£å¼ */
        .btn, .btn-outline { 
            display: flex; align-items: center; justify-content: center; 
            padding: 0 10px; height: 42px; 
            border-radius: 8px; text-decoration: none; 
            font-size: 13px; font-weight: 600; transition: all 0.2s; 
            cursor: pointer; width: 100%; margin-top: auto; 
            box-sizing: border-box; white-space: nowrap; 
        }
        .btn { background-color: var(--brand-red); color: #fff; border: none; }
        .btn:hover { background-color: #c93d39; box-shadow: 0 4px 12px rgba(225, 79, 75, 0.3); }
        .btn-outline { background: transparent; border: 2px solid #e2e8f0; color: #475569; }
        .btn-outline:hover { border-color: var(--brand-red); color: var(--brand-red); background: rgba(225, 79, 75, 0.05); }
        .btn-group { display: flex; gap: 10px; margin-top: auto; width: 100%; }
        .btn-group .btn, .btn-group .btn-outline { margin-top: 0; flex: 1 1 0; width: 0; } 

        .tag { padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 700; display: inline-block; margin-bottom: 12px; letter-spacing: 0.5px; }
        .tag-primary { background: rgba(225, 79, 75, 0.15); color: var(--brand-red); }
        .tag-secondary { background: #f0f0f0; color: #666; }
        .tag-high-risk { background: #fee2e2; color: #ef4444; }

        /* --- æˆ°æƒ…å®¤æ•¸æ“šæ¨£å¼ (New) --- */
        .data-war-room {
            display: grid; grid-template-columns: 3fr 4fr; gap: 24px; margin-bottom: 30px;
        }
        @media (max-width: 1000px) { .data-war-room { grid-template-columns: 1fr; } }

        .stat-hero-card {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            color: #fff; padding: 30px; border-radius: 16px;
            display: flex; flex-direction: column; justify-content: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); position: relative; overflow: hidden;
        }
        .stat-hero-card::after {
            content: ''; position: absolute; right: -20px; bottom: -20px; width: 150px; height: 150px;
            background: rgba(255,255,255,0.05); border-radius: 50%;
        }
        .stat-hero-title { font-size: 14px; font-weight: 600; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; }
        .stat-hero-value { font-size: 48px; font-weight: 800; margin: 10px 0; letter-spacing: -1px; }
        .stat-hero-trend { display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 600; }
        .trend-up { color: #4ade80; } .trend-down { color: #f87171; }
        
        .platform-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }
        .plat-card { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 12px; }
        .plat-icon { font-size: 20px; width: 30px; text-align: center; }
        .plat-info div:first-child { font-size: 12px; color: #cbd5e1; }
        .plat-info div:last-child { font-size: 18px; font-weight: 700; }

        .chart-section { background: #fff; padding: 20px; border-radius: 16px; box-shadow: var(--shadow-sm); min-height: 350px; display: flex; flex-direction: column;}

        /* --- åŸæœ‰ Dashboard æ¨£å¼èª¿æ•´ --- */
        .dashboard-stats { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        @media (max-width: 900px) { .dashboard-stats { grid-template-columns: 1fr; } }
        
        .chart-card { background: #fff; padding: 20px; border-radius: 12px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column; min-height: 300px; }
        .chart-title { font-size: 16px; font-weight: 700; color: #333; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;}
        .mini-roadmap { list-style: none; padding: 0; margin: 0; flex: 1; overflow-y: auto; }
        .mini-roadmap li { padding: 12px 0; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center; justify-content: space-between; }
        .mini-roadmap li:last-child { border-bottom: none; }
        .roadmap-info { display: flex; flex-direction: column; }
        .roadmap-title { font-size: 14px; font-weight: 600; color: #333; }
        .roadmap-date { font-size: 12px; color: #94a3b8; margin-top: 2px; }

        .table-container { overflow-x: auto; border-radius: 12px; box-shadow: var(--shadow-sm); }
        .tech-table { width: 100%; border-collapse: collapse; background: #fff; }
        .tech-table th { background: #091632; text-align: left; padding: 16px; font-size: 13px; color: #fff; text-transform: uppercase; letter-spacing: 1px; }
        .tech-table td { padding: 16px; border-bottom: 1px solid #eee; font-size: 15px; color: #333; }
        .status-dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; margin-right: 8px; background: var(--brand-red); box-shadow: 0 0 8px var(--brand-red); }

        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); backdrop-filter: blur(2px); align-items: center; justify-content: center; }
        .modal-content { background-color: #fff; border-radius: 16px; width: 90%; max-width: 640px; height: 85%; box-shadow: 0 20px 40px rgba(0,0,0,0.2); position: relative; overflow: hidden; animation: modalPop 0.3s cubic-bezier(0.16, 1, 0.3, 1); display: flex; flex-direction: column; }
        @keyframes modalPop { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .close-modal { position: absolute; right: 20px; top: 15px; font-size: 28px; cursor: pointer; color: #666; z-index: 10; background: rgba(255,255,255,0.8); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; }
        .close-modal:hover { color: #000; background: #fff; }
        iframe.gform-frame { width: 100%; flex: 1; border: none; }

        /* --- Blog & Editor CSS --- */
        .blog-container { max-width: 800px; margin: 0 auto; }
        .blog-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .blog-timeline { position: relative; padding-left: 20px; border-left: 2px solid #e2e8f0; min-height: 200px;}
        .blog-post { position: relative; background: #fff; border-radius: 12px; padding: 24px; margin-bottom: 30px; box-shadow: var(--shadow-sm); border: 1px solid rgba(0,0,0,0.05); }
        .blog-post::before { content: ''; position: absolute; left: -27px; top: 24px; width: 12px; height: 12px; background: var(--brand-red); border-radius: 50%; border: 3px solid #fff; box-shadow: 0 0 0 3px #e2e8f0; }
        .post-meta { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; }
        .post-info { display: flex; flex-direction: column; gap: 5px; }
        .post-date { font-weight: 700; color: #64748b; font-size: 14px; }
        .post-version { background: #f1f5f9; padding: 2px 8px; border-radius: 4px; font-size: 12px; color: #475569; display: inline-block; width: fit-content;}
        .status-badge { font-size: 12px; padding: 4px 10px; border-radius: 20px; font-weight: 700; color: #fff; display: inline-block; }
        .status-released { background: #10b981; } 
        .status-beta { background: #3b82f6; }
        .status-progress { background: #f59e0b; }
        .status-planning { background: #8b5cf6; }
        .status-hold { background: #94a3b8; }
        .post-content h4 { font-size: 20px; margin-bottom: 12px; color: #1e293b; }
        .post-content p { color: #475569; line-height: 1.7; margin-bottom: 15px; }
        
        /* ä¿®æ­£ï¼šæ¸…å–®ç¸®æ’èˆ‡å°é½Š */
        .post-content ul, .post-content ol { padding-left: 25px; margin-left: 5px; color: #475569; margin-bottom: 15px; }
        .post-content li { margin-bottom: 8px; }
        
        .post-content img { max-width: 100%; height: auto; border-radius: 8px; margin: 10px 0; display: block; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .post-tags { display: flex; gap: 8px; }
        .tag-small { font-size: 11px; padding: 3px 8px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 4px; color: #64748b; }
        .loading-state { padding: 40px; text-align: center; color: #64748b; }
        .pagination-controls { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 30px; padding-bottom: 30px; }
        .pagination-btn { background: #fff; border: 1px solid #e2e8f0; padding: 8px 16px; border-radius: 8px; cursor: pointer; color: #475569; font-size: 14px; transition: all 0.2s; }
        .pagination-btn:hover:not(:disabled) { background: #f8fafc; color: var(--brand-red); border-color: var(--brand-red); }
        .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .pagination-info { font-size: 14px; color: #64748b; font-weight: 600; }

        /* Editor CSS */
        .editor-container { padding: 30px; overflow-y: auto; }
        .editor-title { font-size: 20px; font-weight: 700; margin-bottom: 20px; }
        .editor-field { margin-bottom: 15px; }
        .editor-label { display: block; margin-bottom: 5px; font-size: 13px; font-weight: 600; color: #64748b; }
        .editor-input, .editor-select, .editor-textarea { width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; font-family: inherit; }
        .editor-textarea { min-height: 120px; resize: vertical; }

        .rich-editor-toolbar { background: #f8fafc; border: 1px solid #e2e8f0; border-bottom: none; border-radius: 8px 8px 0 0; padding: 8px; display: flex; gap: 5px; flex-wrap: wrap; align-items: center; }
        .toolbar-btn { background: #fff; border: 1px solid #cbd5e1; border-radius: 4px; padding: 5px 10px; cursor: pointer; color: #475569; transition: all 0.2s; }
        .toolbar-btn:hover { background: #e2e8f0; color: #000; }
        .rich-editor-content { width: 100%; padding: 15px; border: 1px solid #e2e8f0; border-radius: 0 0 8px 8px; min-height: 200px; font-family: inherit; resize: vertical; overflow-y: auto; background: #fff; outline: none; line-height: 1.6; color: #333; }
        /* ç·¨è¼¯å™¨å…§çš„æ¸…å–®ä¹ŸåŒæ­¥ä¿®æ­£ */
        .rich-editor-content ul, .rich-editor-content ol { padding-left: 20px; margin-bottom: 10px; }
        .rich-editor-content p { margin-bottom: 10px; }
        .rich-editor-content b, .rich-editor-content strong { font-weight: 700; }
        .rich-editor-content img { max-width: 100%; height: auto; border-radius: 4px; margin: 5px 0; }
        .toolbar-color-input { width: 24px; height: 24px; padding: 0; border: none; background: transparent; cursor: pointer; vertical-align: middle; }

        /* --- æ–°å¢ï¼šæ–‡ä»¶é é¢æ¨£å¼ --- */
        .doc-layout { display: flex; gap: 40px; }
        .doc-sidebar { width: 200px; border-right: 1px solid #e2e8f0; padding-right: 20px; flex-shrink: 0; }
        .doc-toc-title { font-size: 12px; font-weight: 700; color: #94a3b8; text-transform: uppercase; margin-bottom: 15px; letter-spacing: 1px; }
        .doc-toc-link { display: block; padding: 8px 0; color: #475569; font-size: 14px; text-decoration: none; border-bottom: 1px solid transparent; transition: all 0.2s; }
        .doc-toc-link:hover { color: var(--brand-red); padding-left: 5px; }
        .doc-content { flex: 1; max-width: 800px; }
        .doc-header { margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #e2e8f0; }
        .doc-title { font-size: 28px; font-weight: 800; color: #1e293b; margin-bottom: 10px; }
        .doc-meta { font-size: 13px; color: #64748b; }
        .doc-body { line-height: 1.8; color: #334155; }
        .doc-body h2 { font-size: 20px; font-weight: 700; color: #0f172a; margin: 30px 0 15px; border-left: 4px solid var(--brand-red); padding-left: 10px; }
        .doc-body p { margin-bottom: 15px; }
        .doc-body ul { padding-left: 20px; margin-bottom: 20px; }
        .doc-alert { background: #fff1f2; border: 1px solid #fda4af; padding: 15px; border-radius: 8px; color: #9f1239; margin: 20px 0; font-size: 14px; display: flex; gap: 10px; align-items: start; }
    </style>
</head>
<body>

    <!-- è¨±é¡˜æ±  Modal (æ–°ç‰ˆï¼šè‡ªå®šç¾©è¡¨å–® - å·²ç§»é™¤ Email) -->
    <div id="bugModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close-modal" onclick="closeModal('bugModal')">&times;</span>
            <div class="editor-container">
                <div class="editor-title">ğŸ’¬ è¨±é¡˜æ±  / å•é¡Œå›å ±</div>
                <div style="background: #f0f9ff; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; color: #0369a1;">
                    <i class="fa-solid fa-lightbulb"></i> æ„Ÿè¬æ‚¨çš„å›é¥‹ï¼é€™äº›å…§å®¹æœƒç›´æ¥å‚³é€åˆ°ç”¢å“éƒ¨é–€ï¼Œæˆ‘å€‘å°‡ç›¡å¿«è©•ä¼°ã€‚
                </div>

                <div class="editor-field">
                    <!-- ä¿®æ”¹ï¼šæç¤ºæ”¹ç‚º Slack ID -->
                    <label class="editor-label">å§“å (Slack ID) *</label>
                    <input type="text" id="bugName" class="editor-input" placeholder="ä¾‹å¦‚ï¼šAlex (alex_chen)">
                </div>

                <div class="editor-field">
                    <label class="editor-label">é¡å‹ *</label>
                    <select id="bugType" class="editor-select">
                        <option value="éœ€æ±‚">ğŸ™ æ–°å¢éœ€æ±‚ (Feature Request)</option>
                        <option value="Bug">ğŸ› ç³»çµ± Bug å›å ±</option>
                        <option value="å…¶ä»–">ğŸ’¬ å…¶ä»–å»ºè­°</option>
                    </select>
                </div>

                <div class="editor-field">
                    <label class="editor-label">å•é¡Œæˆ–å»ºè­°èªªæ˜ *</label>
                    <textarea id="bugContent" class="editor-textarea" placeholder="è«‹è©³ç´°èªªæ˜æ‚¨é‡åˆ°çš„ç‹€æ³ï¼Œæˆ–å¸Œæœ›æ–°å¢çš„åŠŸèƒ½..."></textarea>
                </div>

                <button class="btn" onclick="submitBugReport()">é€å‡ºç•™è¨€</button>
            </div>
        </div>
    </div>

    <!-- æ–°å¢æ—¥èªŒç·¨è¼¯å™¨ Modal -->
    <div id="postEditorModal" class="modal">
        <div class="modal-content" style="max-width: 750px;">
            <span class="close-modal" onclick="closeModal('postEditorModal')">&times;</span>
            <div class="editor-container">
                <div class="editor-title">ğŸ“ æ–°å¢ç”¢å“æ—¥èªŒ</div>
                <div style="background: #f0f9ff; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; color: #0369a1;">
                    <i class="fa-solid fa-circle-info"></i> <strong>ä½¿ç”¨èªªæ˜ï¼š</strong>åœ¨æ­¤è™•ç·¨è¼¯å®Œå…§å®¹å¾Œï¼Œé»æ“Šã€Œè¤‡è£½æ•´åˆ—è³‡æ–™ã€ï¼Œç„¶å¾Œåˆ° Google Sheet çš„ <strong>A æ¬„ (Date)</strong> è²¼ä¸Šå³å¯ã€‚
                </div>
                <div class="grid-2" style="margin-bottom: 0;">
                    <div class="editor-field">
                        <label class="editor-label">æ—¥æœŸ (Date)</label>
                        <input type="date" id="postDate" class="editor-input">
                    </div>
                    <div class="editor-field">
                        <label class="editor-label">ç‰ˆæœ¬è™Ÿ (Version)</label>
                        <input type="text" id="postVersion" class="editor-input" placeholder="e.g. v2.5.1">
                    </div>
                </div>
                <div class="grid-2" style="margin-bottom: 0;">
                    <div class="editor-field">
                        <label class="editor-label">ç‹€æ…‹ (Status)</label>
                        <select id="postStatus" class="editor-select">
                            <option value="Released">ğŸŸ¢ å·²é‡‹å‡º (Released)</option>
                            <option value="Testing">ğŸ”µ æ¸¬è©¦ä¸­ (Testing)</option>
                            <option value="In Progress">ğŸŸ¡ é–‹ç™¼ä¸­ (In Progress)</option>
                            <option value="Planning">ğŸŸ£ å¾…è¨è«– (Planning)</option>
                            <option value="Hold">âšªï¸ å·²æš«åœ (Hold)</option>
                        </select>
                    </div>
                    <div class="editor-field">
                        <label class="editor-label">å—çœ¾ (Role)</label>
                        <select id="postRole" class="editor-select">
                            <option value="All">å…¨é«”äººå“¡ (All)</option>
                            <option value="BD">æ¥­å‹™å°ˆç”¨ (BD Only)</option>
                            <option value="IM">åŸ·è¡Œå°ˆç”¨ (IM Only)</option>
                        </select>
                    </div>
                </div>
                <div class="editor-field">
                    <label class="editor-label">æ¨™é¡Œ (Title) <span style="color:red;">*å¿…å¡«</span></label>
                    <input type="text" id="postTitle" class="editor-input" placeholder="æœ¬æ¬¡æ›´æ–°çš„é‡é»æ¨™é¡Œ">
                </div>
                <div class="editor-field">
                    <label class="editor-label">æ¨™ç±¤ (Tags, é€—è™Ÿåˆ†éš”)</label>
                    <input type="text" id="postTags" class="editor-input" placeholder="AnyTag, Feature, Fix">
                </div>
                
                <!-- è¦–è¦ºåŒ–ç·¨è¼¯å™¨ -->
                <div class="editor-field">
                    <label class="editor-label">å…§å®¹ (Content)</label>
                    <div class="rich-editor-wrapper">
                        <div class="rich-editor-toolbar">
                            <button class="toolbar-btn" onmousedown="saveSelection()" onclick="restoreSelection(); formatDoc('bold')" title="ç²—é«”"><i class="fa-solid fa-bold"></i></button>
                            <button class="toolbar-btn" onmousedown="saveSelection()" onclick="restoreSelection(); formatDoc('italic')" title="æ–œé«”"><i class="fa-solid fa-italic"></i></button>
                            <button class="toolbar-btn" onmousedown="saveSelection()" onclick="restoreSelection(); formatDoc('underline')" title="åº•ç·š"><i class="fa-solid fa-underline"></i></button>
                            
                            <!-- é¡è‰²é¸æ“‡å™¨ -->
                            <span style="border-right: 1px solid #cbd5e1; margin: 0 5px;"></span>
                            <div style="display: inline-flex; align-items: center; border: 1px solid #cbd5e1; border-radius: 4px; padding: 0 5px; background: #fff;" title="æ–‡å­—é¡è‰²">
                                <i class="fa-solid fa-font" style="font-size: 12px; color: #475569; margin-right: 2px;"></i>
                                <input type="color" onmousedown="saveSelection()" oninput="restoreSelection(); formatDoc('foreColor', this.value)" class="toolbar-color-input" value="#000000">
                            </div>

                            <span style="border-right: 1px solid #cbd5e1; margin: 0 5px;"></span>
                            <button class="toolbar-btn" onmousedown="saveSelection()" onclick="restoreSelection(); formatDoc('insertUnorderedList')" title="æ¸…å–®åˆ—è¡¨"><i class="fa-solid fa-list-ul"></i></button>
                            <button class="toolbar-btn" onmousedown="saveSelection()" onclick="restoreSelection(); formatDoc('insertOrderedList')" title="æ•¸å­—åˆ—è¡¨"><i class="fa-solid fa-list-ol"></i></button>
                            <span style="border-right: 1px solid #cbd5e1; margin: 0 5px;"></span>
                            <button class="toolbar-btn" onclick="addLink()" title="æ’å…¥é€£çµ"><i class="fa-solid fa-link"></i></button>
                            <!-- æ™ºæ…§åœ–ç‰‡æŒ‰éˆ• -->
                            <button class="toolbar-btn" onclick="addImage()" title="æ’å…¥åœ–ç‰‡ (æ”¯æ´ Google Drive åˆ†äº«é€£çµ)"><i class="fa-regular fa-image"></i></button>
                            
                            <button class="toolbar-btn" onclick="formatDoc('removeFormat')" title="æ¸…é™¤æ ¼å¼"><i class="fa-solid fa-eraser"></i></button>
                        </div>
                        <div id="richEditor" class="rich-editor-content" contenteditable="true">
                            <p>è«‹åœ¨æ­¤è¼¸å…¥å…§å®¹...</p>
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="copyRowForSheet()">ğŸ“‘ è¤‡è£½æ•´åˆ—è³‡æ–™ (çµ¦ Sheet ç”¨)</button>
            </div>
        </div>
    </div>

    <nav class="sidebar">
        <div class="brand"><span>â—</span> TAIWAN<br>AnyTag/AnyCreator<br>Support Hub</div>
        <div class="nav-group">
            <div class="nav-title">MAIN MENU</div>
            <div class="nav-item active" onclick="showPage('dashboard', this)"><i class="fa-solid fa-chart-line"></i> Dashboard</div>
            
            <!-- ä¿®æ”¹ï¼šAnyTag å¹³å°æŒ‡å— (å¯å±•é–‹) -->
            <div class="nav-item" onclick="toggleSubmenu('anytag-submenu', this)">
                <i class="fa-solid fa-bullseye"></i> AnyTag å¹³å°æŒ‡å—
                <i class="fa-solid fa-chevron-right nav-expand-icon"></i>
            </div>
            <!-- å­é¸å–® -->
            <div id="anytag-submenu" class="submenu">
                <div class="submenu-item" onclick="showPage('anytag-sales', this)">
                    <i class="fa-solid fa-circle" style="font-size: 6px;"></i> æ¥­å‹™é‡é»åŠŸèƒ½èªªæ˜
                </div>
                <div class="submenu-item" onclick="showPage('anytag-ops', this)">
                    <i class="fa-solid fa-circle" style="font-size: 6px;"></i> åŸ·è¡Œæ“ä½œæ‰‹å†Š
                </div>
            </div>

            <div class="nav-item" onclick="showPage('anycreator', this)"><i class="fa-solid fa-wand-magic-sparkles"></i> AnyCreator å‰µä½œè€…</div>
        </div>
        <div class="nav-group">
            <div class="nav-title">SUPPORT & SALES</div>
            <div class="nav-item" onclick="showPage('troubleshoot', this)"><i class="fa-solid fa-screwdriver-wrench"></i> ç–‘é›£æ’è§£ (Trouble)</div>
            <div class="nav-item" onclick="showPage('resources', this)"><i class="fa-solid fa-folder-open"></i> è³‡æºä¸­å¿ƒ (Resources)</div>
        </div>
        
        <div style="margin-top: auto; font-size: 11px; color: #6d7f96; padding-left: 12px; line-height: 1.5;">
            AnyMind Group Â© 2025<br>Internal Use Only<br>
            <span style="color: var(--brand-red);">v.0.0.1 (Beta)</span>
        </div>
    </nav>

    <main class="main">
        <div class="top-bar">
            <div class="page-title">
                <h1 id="header-title">AnyTag/AnyCreator Support Hub</h1>
                <p id="header-desc">Welcomeï¼é‡åˆ°AnyTag/AnyCreatorçš„ç–‘é›£é›œç—‡äº†å—ï¼Ÿæˆ‘ä¾†å¹«ä½ è§£æ±ºï¼</p>
            </div>
            <div class="search-box">
                <span class="search-icon"><i class="fa-solid fa-magnifying-glass"></i></span>
                <input type="text" id="searchInput" placeholder="æœå°‹ SOPã€FAQ æˆ–è³‡æº..." onkeyup="smartSearch()">
            </div>
        </div>

        <div id="dashboard" class="section active">
            <!-- æ•¸æ“šæˆ°æƒ…å€å¡Š (New) -->
            <div class="data-war-room">
                <!-- å·¦å´ï¼šæ ¸å¿ƒæŒ‡æ¨™èˆ‡å¹³å°åˆ†ä½ˆ -->
                <div style="display:flex; flex-direction:column; gap:20px;">
                    <div class="stat-hero-card">
                        <div class="stat-hero-title">TOTAL UNIQUE INFLUENCERS</div>
                        <div class="stat-hero-value" id="hero-total">0</div>
                        <div class="stat-hero-trend" id="hero-trend">
                            <i class="fa-solid fa-minus"></i> è¼‰å…¥ä¸­...
                        </div>
                    </div>
                    
                    <div class="platform-grid">
                        <!-- IG -->
                        <div class="plat-card">
                            <div class="plat-icon" style="color:#E1306C"><i class="fa-brands fa-instagram"></i></div>
                            <div class="plat-info">
                                <div>Instagram</div>
                                <div id="stat-ig">0</div>
                            </div>
                        </div>
                        <!-- FB -->
                        <div class="plat-card">
                            <div class="plat-icon" style="color:#1877F2"><i class="fa-brands fa-facebook"></i></div>
                            <div class="plat-info">
                                <div>Facebook</div>
                                <div id="stat-fb">0</div>
                            </div>
                        </div>
                        <!-- YT -->
                        <div class="plat-card">
                            <div class="plat-icon" style="color:#FF0000"><i class="fa-brands fa-youtube"></i></div>
                            <div class="plat-info">
                                <div>YouTube</div>
                                <div id="stat-yt">0</div>
                            </div>
                        </div>
                        <!-- TikTok -->
                        <div class="plat-card">
                            <div class="plat-icon" style="color:#000000"><i class="fa-brands fa-tiktok"></i></div>
                            <div class="plat-info">
                                <div>TikTok</div>
                                <div id="stat-tiktok">0</div>
                            </div>
                        </div>
                          <!-- Threads -->
                        <div class="plat-card">
                            <div class="plat-icon" style="color:#000000"><i class="fa-brands fa-threads"></i></div>
                            <div class="plat-info">
                                <div>Threads</div>
                                <div id="stat-threads">0</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å³å´ï¼šæˆé•·è¶¨å‹¢åœ– -->
                <div class="chart-section">
                    <div style="font-weight:700; margin-bottom:15px; color:#333;">ğŸ“Š ç¶²ç´…è³‡æ–™åº«æˆé•·è¶¨å‹¢ (Database Growth)</div>
                    <div style="flex:1; position:relative;">
                        <canvas id="influencerGrowthChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- ä¸‹æ–¹ï¼šèˆŠæœ‰çš„ç”¢å“æ›´æ–°è¶¨å‹¢èˆ‡ Roadmap -->
            <div class="dashboard-stats">
                <div class="chart-card" style="flex: 2;">
                    <div class="chart-title">
                        <span>ğŸ› ï¸ ç”¢å“åŠŸèƒ½æ›´æ–°é »ç‡ (Update Velocity)</span>
                        <span style="font-size:12px; font-weight:400; color:#666;">è¿‘ 3 å€‹æœˆ</span>
                    </div>
                    <div style="flex: 1; position: relative;">
                         <canvas id="updateChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card" style="flex: 1;">
                    <div class="chart-title">ğŸš€ è¿‘æœŸæ›´æ–° (Roadmap)</div>
                    <ul class="mini-roadmap" id="mini-roadmap-list">
                        <li style="text-align:center; color:#999; margin-top:20px;">è¼‰å…¥ä¸­...</li>
                    </ul>
                    <button class="btn-outline" style="margin-top:10px; width:100%; height:35px;" onclick="window.scrollTo(0,0); showPage('updates')">æŸ¥çœ‹å®Œæ•´æ—¥èªŒ</button>
                </div>
            </div>

            <h3 style="margin-bottom: 20px; font-weight: 700;">æ·å¾‘ (Quick Access)</h3>
            
            <div class="tabs-container">
                <button class="tab-btn active" onclick="filterRole('All')">å…¨éƒ¨</button>
                <button class="tab-btn" onclick="filterRole('BD')">æ¥­å‹™å°ˆå€ (BD)</button>
                <button class="tab-btn" onclick="filterRole('IM')">åŸ·è¡Œå°ˆå€ (IM)</button>
            </div>

            <div id="quick-access-container" class="grid-4"></div>

            <h3 style="margin-bottom: 20px; font-weight: 700;">å¹³å°ç‹€æ…‹æ¦‚è¦½</h3>
            <div class="table-container">
                <table class="tech-table">
                    <thead><tr><th>å¹³å°åç¨±</th><th>ä½¿ç”¨å°è±¡</th><th>æ ¸å¿ƒåŠŸèƒ½</th><th>ç‹€æ…‹</th></tr></thead>
                    <tbody>
                        <tr><td><strong>AnyTag</strong></td><td>å“ç‰Œå®¢æˆ¶ / å…§éƒ¨äººå“¡</td><td>ç¶²ç´…æœå°‹ã€æ•¸æ“šåˆ†æã€å°ˆæ¡ˆç®¡ç†</td><td><span class="status-dot"></span>é‹ä½œä¸­</td></tr>
                        <tr><td><strong>AnyCreator</strong></td><td>ç¶²ç´… / å‰µä½œè€…</td><td>æ¥æ¡ˆåª’åˆã€é€£çµç®¡ç†ã€å¸³è™Ÿåˆ†æ</td><td><span class="status-dot"></span>é‹ä½œä¸­</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ç”¢å“æ›´æ–°æ—¥èªŒé é¢ -->
        <div id="updates" class="section">
            <div class="blog-container">
                <div class="blog-header">
                    <!-- ä¿®æ­£ï¼šåŠ å…¥ scrollTo(0,0) -->
                    <button class="btn-outline" style="width: auto;" onclick="window.scrollTo(0,0); showPage('dashboard')"><i class="fa-solid fa-arrow-left"></i> è¿”å›å„€è¡¨æ¿</button>
                    <!-- æ–°å¢æ—¥èªŒæŒ‰éˆ• -->
                    <button class="btn" style="width: auto;" onclick="openEditor()">ğŸ“ æ–°å¢æ—¥èªŒ (Admin)</button>
                </div>
                
                <!-- æ—¥èªŒç¯©é¸å™¨ -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <div class="tabs-container" style="margin-bottom: 0;">
                        <button class="tab-btn active" onclick="filterBlogRole('All')">å…¨éƒ¨æ›´æ–°</button>
                        <button class="tab-btn" onclick="filterBlogRole('BD')">æ¥­å‹™é‡é» (BD)</button>
                        <button class="tab-btn" onclick="filterBlogRole('IM')">åŠŸèƒ½æ“ä½œ (IM)</button>
                    </div>
                    <div style="display: flex; gap: 10px;">
                         <select id="statusFilter" class="filter-select" onchange="filterBlogStatus(this.value)">
                            <option value="All">å…¨éƒ¨ç‹€æ…‹</option>
                            <option value="Released">ğŸŸ¢ å·²é‡‹å‡º</option>
                            <option value="Testing">ğŸ”µ æ¸¬è©¦ä¸­</option>
                            <option value="In Progress">ğŸŸ¡ é–‹ç™¼ä¸­</option>
                            <option value="Planning">ğŸŸ£ å¾…è¨è«–</option>
                            <option value="Hold">âšªï¸ å·²æš«åœ</option>
                        </select>
                        <select id="sortFilter" class="filter-select" onchange="sortBlog(this.value)">
                            <option value="desc">æœ€æ–°å„ªå…ˆ</option>
                            <option value="asc">æœ€èˆŠå„ªå…ˆ</option>
                        </select>
                    </div>
                </div>

                <div class="blog-timeline" id="blog-container">
                    <div class="loading-state"><i class="fa-solid fa-circle-notch fa-spin"></i> æ­£åœ¨è¼‰å…¥æ›´æ–°æ—¥èªŒ...</div>
                </div>
                
                <div id="pagination" class="pagination-controls" style="display: none;">
                    <button class="pagination-btn" onclick="changePage(-1)" id="prevPageBtn">ä¸Šä¸€é </button>
                    <span class="pagination-info" id="pageInfo">ç¬¬ 1 / 1 é </span>
                    <button class="pagination-btn" onclick="changePage(1)" id="nextPageBtn">ä¸‹ä¸€é </button>
                </div>
            </div>
        </div>

        <!-- æ–°å¢é é¢ï¼šæ¥­å‹™é‡é»åŠŸèƒ½èªªæ˜ -->
        <div id="anytag-sales" class="section">
            <div class="blog-container">
                 <div class="doc-layout">
                     <div class="doc-sidebar">
                         <div class="doc-toc-title">ON THIS PAGE</div>
                         <a href="#intro" class="doc-toc-link">åŠŸèƒ½ç¸½è¦½</a>
                         <a href="#search" class="doc-toc-link">ç¶²ç´…æœå°‹äº®é»</a>
                         <a href="#report" class="doc-toc-link">å ±è¡¨èˆ‡æ•¸æ“š</a>
                     </div>
                     <div class="doc-content">
                         <div class="doc-header">
                             <h1 class="doc-title">æ¥­å‹™é‡é»åŠŸèƒ½èªªæ˜</h1>
                             <div class="doc-meta">æœ€å¾Œæ›´æ–°ï¼š2025-12-10 | å°è±¡ï¼šBusiness Development (BD)</div>
                         </div>
                         <div class="doc-body">
                             <p>é€™è£¡å°‡åˆ—å‡º AnyTag é‡å°å“ç‰Œå®¢æˆ¶æœ€æ ¸å¿ƒçš„éŠ·å”®è³£é»ã€‚è«‹æ¥­å‹™åŒä»åœ¨ææ¡ˆæ™‚å‹™å¿…å¼·èª¿ä»¥ä¸‹å„ªå‹¢ã€‚</p>
                             
                             <h2 id="search">1. ç¶²ç´…æœå°‹äº®é» (Discovery)</h2>
                             <p>AnyTag æ“æœ‰äºæ´²æœ€å¤§çš„ç¶²ç´…è³‡æ–™åº«ï¼Œæ”¯æ´ AI æ™ºæ…§æœå°‹ã€‚</p>
                             <div class="doc-alert">
                                 <i class="fa-solid fa-circle-exclamation"></i>
                                 <div><strong>æ³¨æ„ï¼š</strong>å‘å®¢æˆ¶ä»‹ç´¹æ™‚ï¼Œè«‹å¼·èª¿æˆ‘å€‘å¯ä»¥æœå°‹åˆ°ã€Œæœªè¨»å†Šã€çš„å…¬é–‹è³‡æ–™ï¼Œé€™æ˜¯ç«¶å“åšä¸åˆ°çš„ã€‚</div>
                             </div>
                             
                             <h2 id="report">2. å ±è¡¨èˆ‡æ•¸æ“š (Reporting)</h2>
                             <p>è‡ªå‹•ç”Ÿæˆçš„çµæ¡ˆå ±å‘Šï¼ŒåŒ…å«è©³ç´°çš„å—çœ¾è¼ªå»“åˆ†æã€‚</p>
                             <ul>
                                 <li>å³æ™‚æ•¸æ“šè¿½è¹¤ (Real-time Tracking)</li>
                                 <li>ç«¶å“åˆ†æåŠŸèƒ½ (Competitor Analysis)</li>
                             </ul>
                         </div>
                     </div>
                 </div>
            </div>
        </div>

        <!-- æ–°å¢é é¢ï¼šåŸ·è¡Œæ“ä½œæ‰‹å†Š -->
        <div id="anytag-ops" class="section">
            <div class="blog-container">
                <div class="doc-layout">
                    <div class="doc-sidebar">
                        <div class="doc-toc-title">æ“ä½œç›®éŒ„</div>
                        <a href="#setup" class="doc-toc-link">å°ˆæ¡ˆè¨­å®š</a>
                        <a href="#invite" class="doc-toc-link">é‚€è«‹ç¶²ç´…</a>
                    </div>
                    <div class="doc-content">
                        <div class="doc-header">
                            <h1 class="doc-title">åŸ·è¡Œæ“ä½œæ‰‹å†Š (SOP)</h1>
                            <div class="doc-meta">æœ€å¾Œæ›´æ–°ï¼š2025-12-10 | å°è±¡ï¼šInfluencer Marketing (IM)</div>
                        </div>
                        <div class="doc-body">
                            <p>æœ¬æ‰‹å†Šè©³ç´°èªªæ˜å°ˆæ¡ˆåŸ·è¡Œçš„æ¨™æº–ä½œæ¥­æµç¨‹ã€‚</p>
                            
                            <h2 id="setup">1. å°ˆæ¡ˆè¨­å®š (Campaign Setup)</h2>
                            <p>åœ¨é–‹å§‹ä»»ä½•å°ˆæ¡ˆå‰ï¼Œè«‹ç¢ºä¿å·²å»ºç«‹ Campaign ä¸¦è¨­å®šå¥½é ç®—èˆ‡èµ°æœŸã€‚</p>
                            
                            <h2 id="invite">2. é‚€è«‹ç¶²ç´…</h2>
                            <p>å¦‚ä½•é€éç³»çµ±ç™¼é€é‚€è«‹ä¿¡çµ¦ç¶²ç´…ï¼Œä¸¦è¿½è¹¤å›æ‡‰ç‹€æ…‹ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="anycreator" class="section"><div class="card"><h3>AnyCreator æŒ‡å—å»ºç½®ä¸­...</h3></div></div>
        <div id="troubleshoot" class="section"><div class="card"><h3>ç–‘é›£æ’è§£å»ºç½®ä¸­...</h3></div></div>
        <div id="resources" class="section"><div class="card"><h3>è³‡æºä¸­å¿ƒå»ºç½®ä¸­...</h3></div></div>

    </main>

    <script>
        const LOGGER_URL = "YOUR_PERSONAL_SCRIPT_URL_HERE"; 
        const BLOG_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzlMmOsrQd41GTZdC0MjS_z_ZZd8lIqEsb18n3oHis1rtNKLDtw2bd0DGDymWcedQPn9Q/exec";
        // âš ï¸ è¨±é¡˜æ±  (Bug Report) çš„ Apps Script URL (æ–°)
        const BUG_REPORT_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyFr_Yv6q-pDPWxQEjMkTINrbJAwmCbcGLc_xaIUlK3IUsC1vXGIlPVlonxOFaEk880/exec";
        
        // âš ï¸ æ–°å¢ï¼šStats æ•¸æ“šçš„ Apps Script URL (å·²æ›´æ–°)
        const STATS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxBYe9GkHGiba9t0IG4LTM7Sl7D_uArUDRwoKl4QhdLpvVOl8uYm6wEqLakaxRbUGY0CQ/exec"; 

        let allBlogPosts = [];
        let filteredPosts = [];
        let currentRoleFilter = 'All';
        let currentStatusFilter = 'All';
        let currentSortOrder = 'desc';
        let currentPage = 1;
        const postsPerPage = 5;

        // è‡ªå‹•åŸ·è¡Œ
        window.onload = function() {
            renderCards(); 
            const editor = document.getElementById('richEditor');
            if (editor) {
                editor.addEventListener('keydown', function(e) {
                    if (e.key === 'Tab') {
                        e.preventDefault();
                        if (e.shiftKey) document.execCommand('outdent', false, null);
                        else document.execCommand('indent', false, null);
                    }
                });
            }
            fetchBlogPosts();
            fetchStatsData(); // æ–°å¢ï¼šæŠ“å– Stats æ•¸æ“š
            startNoticeCarousel();
        };

        // --- æ–°å¢ï¼šæŠ“å– Stats æ•¸æ“šä¸¦ç¹ªåœ– ---
        async function fetchStatsData() {
            if(!STATS_SCRIPT_URL.startsWith("http")) return;
            try {
                const response = await fetch(STATS_SCRIPT_URL + "?t=" + new Date().getTime());
                const data = await response.json();
                renderInfluencerStats(data);
            } catch (error) {
                console.error("Fetch Stats Failed:", error);
            }
        }

        function renderInfluencerStats(data) {
            if (!data || data.length === 0) return;

            // 1. è™•ç†æœ€æ–°æ•¸æ“š (Hero Card & Platform Grid)
            const latest = data[data.length - 1];
            
            // å¡«å…¥æ•¸å€¼ (åŠ ä¸Šåƒåˆ†ä½)
            document.getElementById('hero-total').innerText = Number(latest.total).toLocaleString();
            document.getElementById('stat-ig').innerText = Number(latest.ig).toLocaleString();
            document.getElementById('stat-fb').innerText = Number(latest.fb).toLocaleString();
            document.getElementById('stat-yt').innerText = Number(latest.yt).toLocaleString();
            document.getElementById('stat-tiktok').innerText = Number(latest.tiktok).toLocaleString();
            document.getElementById('stat-threads').innerText = Number(latest.threads).toLocaleString();

            // è¨ˆç®— MoM (æœˆç’°æ¯”)
            // é‚è¼¯ï¼šæ‰¾ 30 å¤©å‰çš„æ•¸æ“šï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡æ‰¾æœ€æ¥è¿‘çš„
            const today = new Date(latest.date);
            const targetDate = new Date(today);
            targetDate.setDate(today.getDate() - 30);
            
            // å°‹æ‰¾æœ€æ¥è¿‘ 30 å¤©å‰çš„è³‡æ–™
            let prevData = data[0];
            let minDiff = Infinity;
            
            data.forEach(item => {
                const d = new Date(item.date);
                const diff = Math.abs(d - targetDate);
                if (diff < minDiff) {
                    minDiff = diff;
                    prevData = item;
                }
            });

            if (prevData && prevData.total > 0) {
                const growth = ((latest.total - prevData.total) / prevData.total) * 100;
                const trendEl = document.getElementById('hero-trend');
                if (growth >= 0) {
                    trendEl.innerHTML = `<span class="trend-up"><i class="fa-solid fa-arrow-trend-up"></i> +${growth.toFixed(1)}% (MoM)</span>`;
                } else {
                    trendEl.innerHTML = `<span class="trend-down"><i class="fa-solid fa-arrow-trend-down"></i> ${growth.toFixed(1)}% (MoM)</span>`;
                }
            }

            // 2. ç¹ªè£½è¶¨å‹¢åœ– (æœ€è¿‘ 3-6 å€‹æœˆ)
            // å–æœ€å¾Œ 6 ç­†è³‡æ–™ (å‡è¨­æ˜¯æœˆæ›´) æˆ–æœ€è¿‘ 180 å¤©çš„è³‡æ–™
            // é€™è£¡ç°¡å–®å–æœ€å¾Œ 6 ç­†é¡¯ç¤º
            const chartData = data.slice(-6); 
            
            const ctx = document.getElementById('influencerGrowthChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: chartData.map(d => d.date),
                    datasets: [{
                        label: 'Total Unique Influencers',
                        data: chartData.map(d => d.total),
                        borderColor: '#E14F4B',
                        backgroundColor: 'rgba(225, 79, 75, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#E14F4B',
                        pointRadius: 5,
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { 
                            beginAtZero: false, // è®“æ›²ç·šæ³¢å‹•æ›´æ˜é¡¯
                            grid: { borderDash: [2, 4] }
                        },
                        x: { grid: { display: false } }
                    }
                }
            });
        }

        // --- å´é‚Šæ¬„ç¸®æ”¾åŠŸèƒ½ ---
        function toggleSubmenu(menuId, element) {
            const submenu = document.getElementById(menuId);
            const isActive = submenu.classList.contains('open');
            
            if (!isActive) {
                submenu.classList.add('open');
                element.classList.add('expanded');
            } else {
                submenu.classList.remove('open');
                element.classList.remove('expanded');
            }
        }

        async function fetchBlogPosts() {
            if(!BLOG_SCRIPT_URL.startsWith("http")) return;
            try {
                const response = await fetch(BLOG_SCRIPT_URL + "?t=" + new Date().getTime());
                const posts = await response.json();
                allBlogPosts = posts; 
                applyFilters(); 
                renderDashboardStats(); 
            } catch (error) {
                console.error("Fetch Blog Failed:", error);
            }
        }

        // ä¿®æ”¹å¾Œçš„ renderDashboardStats (åªé¡¯ç¤ºç”¢å“æ›´æ–°éƒ¨åˆ†ï¼Œç¶²ç´…æ•¸æ“šç”± renderInfluencerStats è™•ç†)
        function renderDashboardStats() {
            if(allBlogPosts.length === 0) return;
            // é€™è£¡åŸæœ¬æ˜¯ç•«åœ–ï¼Œç¾åœ¨æ”¹ç‚ºåªç•« "Product Velocity" (3å€‹æœˆ)
            const monthCounts = {};
            const months = [];
            const today = new Date();
            // æ”¹ç‚º 3 å€‹æœˆ (i=2)
            for(let i=2; i>=0; i--) {
                const d = new Date(today.getFullYear(), today.getMonth() - i, 1);
                const key = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;
                monthCounts[key] = 0;
                months.push(key);
            }
            allBlogPosts.forEach(post => {
                const dateObj = new Date(post.date);
                if (!isNaN(dateObj.getTime())) {
                    const key = `${dateObj.getFullYear()}-${String(dateObj.getMonth()+1).padStart(2,'0')}`;
                    if(monthCounts.hasOwnProperty(key)) monthCounts[key]++;
                }
            });
            const ctx = document.getElementById('updateChart').getContext('2d');
            new Chart(ctx, {
                type: 'line', // ä¿®æ”¹ï¼šæ”¹ç‚ºæ³¢æµªç‹€æŠ˜ç·šåœ–
                data: {
                    labels: months,
                    datasets: [{
                        label: 'åŠŸèƒ½æ›´æ–°æ•¸',
                        data: months.map(m => monthCounts[m]),
                        backgroundColor: 'rgba(59, 130, 246, 0.2)', // ä¿®æ”¹ï¼šåŠé€æ˜å¡«å……è‰²
                        borderColor: '#3b82f6', // ä¿®æ”¹ï¼šç·šæ¢é¡è‰²
                        borderWidth: 3,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#3b82f6',
                        pointRadius: 5,
                        fill: true, // ä¿®æ”¹ï¼šå•Ÿç”¨å¡«å……æ•ˆæœ
                        tension: 0.4 // ä¿®æ”¹ï¼šè¨­å®šæ³¢æµªæ›²ç·šå¼µåŠ›
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { 
                            beginAtZero: true, 
                            ticks: { stepSize: 1 },
                            grid: { borderDash: [2, 4] }
                        },
                        x: { grid: { display: false } }
                    }
                }
            });
            
            // Roadmap æ¸²æŸ“
            const roadmapList = document.getElementById('mini-roadmap-list');
            roadmapList.innerHTML = '';
            const sortedPosts = allBlogPosts.slice().sort((a, b) => new Date(b.date) - new Date(a.date));
            const latestPosts = sortedPosts.slice(0, 4); 
            
            latestPosts.forEach(post => {
                let displayDate = post.date;
                const dateObj = new Date(post.date);
                if (!isNaN(dateObj.getTime())) {
                    const y = dateObj.getFullYear();
                    const m = String(dateObj.getMonth() + 1).padStart(2, '0');
                    const d = String(dateObj.getDate()).padStart(2, '0');
                    displayDate = `${y}-${m}-${d}`;
                }
                let statusClass = 'status-hold';
                let statusText = post.status || 'Unknown';
                if(statusText.includes('Released')) statusClass = 'status-released';
                else if(statusText.includes('Testing')) statusClass = 'status-beta';
                else if(statusText.includes('In Progress')) statusClass = 'status-progress';
                
                const li = document.createElement('li');
                li.innerHTML = `<div class="roadmap-info"><div class="roadmap-title">${post.title}</div><div class="roadmap-date">${displayDate}</div></div><span class="status-badge ${statusClass}" style="font-size:10px; padding:2px 6px;">${statusText}</span>`;
                roadmapList.appendChild(li);
            });
        }

        function filterBlogRole(role) {
            currentRoleFilter = role;
            const buttons = document.querySelectorAll('#updates .tab-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if(btn.innerText.includes(role === 'All' ? 'å…¨éƒ¨' : role)) btn.classList.add('active');
            });
            applyFilters();
        }

        function filterBlogStatus(status) {
            currentStatusFilter = status;
            applyFilters();
        }

        function sortBlog(order) {
            currentSortOrder = order;
            applyFilters();
        }

        function applyFilters() {
            filteredPosts = allBlogPosts.filter(post => {
                const postRole = post.role || 'All';
                const postStatus = post.status || 'Unknown';
                const matchRole = currentRoleFilter === 'All' || postRole === 'All' || postRole === currentRoleFilter;
                const matchStatus = currentStatusFilter === 'All' || postStatus === currentStatusFilter;
                return matchRole && matchStatus;
            });
            filteredPosts.sort((a, b) => {
                const dateA = new Date(a.date);
                const dateB = new Date(b.date);
                return currentSortOrder === 'desc' ? dateB - dateA : dateA - dateB;
            });
            currentPage = 1;
            renderBlogPage();
        }

        function changePage(direction) {
            currentPage += direction;
            renderBlogPage();
            document.querySelector('.blog-container').scrollIntoView({ behavior: 'smooth' });
        }

        function renderBlogPage() {
            const container = document.getElementById('blog-container');
            container.innerHTML = ''; 
            if(filteredPosts.length === 0) {
                container.innerHTML = `<div class="loading-state">æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„ç´€éŒ„ã€‚</div>`;
                document.getElementById('pagination').style.display = 'none';
                return;
            }
            const totalPages = Math.ceil(filteredPosts.length / postsPerPage);
            const start = (currentPage - 1) * postsPerPage;
            const end = start + postsPerPage;
            const pageData = filteredPosts.slice(start, end);
            pageData.forEach(post => {
                let displayDate = post.date;
                const dateObj = new Date(post.date);
                if (!isNaN(dateObj.getTime())) {
                    const y = dateObj.getFullYear();
                    const m = String(dateObj.getMonth() + 1).padStart(2, '0');
                    const d = String(dateObj.getDate()).padStart(2, '0');
                    displayDate = `${y}-${m}-${d}`;
                }
                let statusClass = 'status-hold';
                let statusText = post.status || 'Unknown';
                if(statusText.includes('Released')) statusClass = 'status-released';
                else if(statusText.includes('Testing')) statusClass = 'status-beta';
                else if(statusText.includes('In Progress')) statusClass = 'status-progress';
                else if(statusText.includes('Planning')) statusClass = 'status-planning';
                const statusHtml = `<span class="status-badge ${statusClass}">${statusText}</span>`;
                const tagsHtml = post.tags.map(t => `<span class="tag-small">#${t}</span>`).join('');
                const html = `<div class="blog-post"><div class="post-meta"><div class="post-info"><div class="post-date">${displayDate}</div><span class="post-version">${post.version}</span></div>${statusHtml}</div><div class="post-content"><h4>${post.title}</h4>${post.content}</div><div class="post-tags">${tagsHtml}</div></div>`;
                container.innerHTML += html;
            });
            document.getElementById('pagination').style.display = 'flex';
            document.getElementById('pageInfo').innerText = `ç¬¬ ${currentPage} / ${totalPages} é `;
            document.getElementById('prevPageBtn').disabled = currentPage === 1;
            document.getElementById('nextPageBtn').disabled = currentPage === totalPages;
        }

        // æ–°å¢ï¼šè¨±é¡˜æ± æäº¤åŠŸèƒ½ (Headless Form) - å·²æ›´æ–° Script URL
        function submitBugReport() {
            if(!BUG_REPORT_SCRIPT_URL.startsWith("http") || BUG_REPORT_SCRIPT_URL.includes("YOUR_BUG_REPORT")) {
                alert("âš ï¸ è«‹å…ˆè¨­å®šè¨±é¡˜æ± çš„ Google Apps Script ç¶²å€ï¼");
                return;
            }

            const name = document.getElementById('bugName').value;
            const type = document.getElementById('bugType').value;
            const content = document.getElementById('bugContent').value;
            // ä¿®æ”¹ï¼šè®Šæ•¸åç¨± email æ”¹ç‚º slackIdï¼Œä»¥ç¬¦åˆå¾Œç«¯é‚è¼¯ (é›–ç„¶é€å‡ºçš„ payload æ¬„ä½åç¨±å¯ä»¥ä¸æ”¹ï¼Œä½†ç‚ºäº†èªæ„æ¸…æ™°)
            // é€™è£¡æˆ‘å€‘ç¹¼çºŒç”¨ email é€™å€‹ key å‚³é€ï¼Œå› ç‚º Apps Script é‚£é‚Šæ¥æ”¶çš„æ˜¯ data.emailï¼Œ
            // åªè¦æˆ‘å€‘çŸ¥é“é€™æ¬„ä½ç¾åœ¨å¡«çš„æ˜¯ Slack ID å³å¯ã€‚
            const slackId = document.getElementById('bugName').value; 

            if (!name || !content) {
                alert("âŒ è«‹å¡«å¯«å§“åèˆ‡å…§å®¹ï¼");
                return;
            }

            // ç™¼é€æŒ‰éˆ•è®Šæ›´ç‹€æ…‹
            const btn = document.querySelector('#bugModal .btn');
            const originalText = btn.innerText;
            btn.innerText = "å‚³é€ä¸­...";
            btn.disabled = true;

            // æº–å‚™è³‡æ–™ (æ³¨æ„ key è¦è·Ÿ Apps Script è£¡çš„ data.name, data.email å°æ‡‰)
            const payload = {
                name: name,
                type: type,
                content: content,
                // å› ç‚ºæˆ‘å€‘ç§»é™¤äº† Email è¼¸å…¥æ¡†ï¼Œé€™è£¡å¯ä»¥å‚³é€ Slack ID åˆ° Email æ¬„ä½ï¼Œæˆ–è€…å‚³é€ç©ºå­—ä¸²
                // ç‚ºäº†è®“ Sheet è£¡çš„ Email æ¬„ä½æœ‰æ±è¥¿ï¼Œæˆ‘å€‘æŠŠ Slack ID å¡«é€²å» (æˆ–æ˜¯æ¨™è¨»ä¸€ä¸‹)
                email: "Slack: " + name 
            };

            fetch(BUG_REPORT_SCRIPT_URL, {
                method: "POST",
                mode: "no-cors", // é‡è¦ï¼šè·¨ç¶²åŸŸè¨­å®š
                headers: { "Content-Type": "text/plain" }, // ä½¿ç”¨ text/plain é¿å… CORS preflight
                body: JSON.stringify(payload)
            }).then(() => {
                alert("âœ… ç•™è¨€å·²é€å‡ºï¼æ„Ÿè¬æ‚¨çš„å›é¥‹ã€‚");
                document.getElementById('bugName').value = '';
                document.getElementById('bugContent').value = '';
                closeModal('bugModal');
            }).catch(err => {
                alert("âŒ ç™¼é€å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
                console.error(err);
            }).finally(() => {
                btn.innerText = originalText;
                btn.disabled = false;
            });
        }

        const knowledgeBase = [
            { id: "001", title: "ç¶²ç´…æœå°‹ SOP", desc: "å¦‚ä½•ä½¿ç”¨ AI Search èˆ‡ åœ–ç‰‡æœå°‹æ‰¾åˆ°ç²¾æº–ç¶²ç´…ï¼Ÿ", tag: "User Guide", tagClass: "tag-primary", icon: "fa-solid fa-magnifying-glass-location", btnText: "å‰å¾€æ•™å­¸", btnLink: "#", btnStyle: "btn", riskLevel: "low", category: "AnyTag", roles: ['IM'] },
            { id: "002", title: "æ•¸æ“šæ²’æ›´æ–°ï¼Ÿ", desc: "é‡åˆ°å¹³å°profile pageæ•¸æ“šè·‘ä¸å‡ºä¾†ï¼Ÿå…ˆä¾†é€™è£¡çœ‹è§£æ±ºæ­¥é©Ÿã€‚", tag: "FAQ", tagClass: "tag-secondary", icon: "fa-regular fa-circle-question", btnText: "æŸ¥çœ‹è§£æ±ºæ–¹æ¡ˆ", btnLink: "#", btnStyle: "btn-outline", riskLevel: "low", category: "AnyTag", roles: ['BD', 'IM'] },
            { id: "003", title: "è¨±é¡˜æ±  / å•é¡Œå›å ±", desc: "ç³»çµ±ç•°å¸¸æˆ–æœ‰æ–°éœ€æ±‚ï¼Ÿä¸éœ€è¦å¡«å–®ï¼Œç›´æ¥ç•™è¨€è®“æˆ‘å€‘çŸ¥é“ã€‚", tag: "Wishlist", tagClass: "tag-primary", icon: "fa-solid fa-comments", keywords: "bug, éœ€æ±‚, å»ºè­°, issue, error, éŒ¯èª¤", customHtml: `<div class="btn-group"><button class="btn" onclick="openModal('bugModal')">æˆ‘è¦ç•™è¨€</button><a href="https://docs.google.com/spreadsheets/d/1l2B4IXrtivcZlb_lBjhlaq_coBKE01SoVBGvg_92zmc/edit?gid=0#gid=0" target="_blank" class="btn-outline">æŸ¥çœ‹ç•™è¨€æ¿</a></div>`, riskLevel: "low", category: "System", roles: ['BD', 'IM'] },
            { id: "004", title: "ç”¢å“å‹•æ…‹æ›´æ–°", desc: "AnyTag / AnyCreator æœ€æ–°åŠŸèƒ½ç™¼å¸ƒèˆ‡å„ªåŒ–æ—¥èªŒã€‚", tag: "Updates", tagClass: "tag-secondary", icon: "fa-solid fa-rocket", customHtml: `<button class="btn-outline" onclick="window.scrollTo(0,0); showPage('updates'); fetchBlogPosts(); logDecision('004', 'ç”¢å“å‹•æ…‹æ›´æ–°')">æŸ¥çœ‹æ—¥èªŒ</button>`, riskLevel: "low", category: "System", roles: ['BD', 'IM'] }, 
            { id: "005", title: "Marketplace éŠ·å”®é–€æª»", desc: "ç¶²ç´…åª’åˆåŠŸèƒ½(Marketplace)åœ¨å°ç£è½åœ°çš„é–€æª»é™åˆ¶èªªæ˜ã€‚", tag: "Sales Kit", tagClass: "tag-primary", icon: "fa-solid fa-shop", btnText: "æŸ¥çœ‹è¦ç¯„è¡¨", btnLink: "https://docs.google.com/spreadsheets/d/1gHKGwOajXzjoXorGBgo9chxLAl0lH4SngOfdgsTDvP4/edit?gid=0#gid=0", btnStyle: "btn", riskLevel: "low", category: "Sales", roles: ['BD'] },
            { id: "006", title: "çµæ¡ˆå ±å‘Šç¯„æœ¬", desc: "æ¨™æº–çµæ¡ˆå ±å‘Š PPT æ¨¡æ¿èˆ‡æ•¸æ“šå¡«å¯«èªªæ˜ã€‚", tag: "Template", tagClass: "tag-secondary", icon: "fa-solid fa-file-powerpoint", btnText: "ä¸‹è¼‰ PPT", btnLink: "#", btnStyle: "btn-outline", riskLevel: "low", category: "IM", roles: ['IM'] },
            { id: "999", title: "å¸³è™Ÿå°ç¦ç”³è¨´", desc: "é‡åˆ°å‰µä½œè€…å¸³è™Ÿè¢«å°é–æˆ–é‡‘æµå•é¡Œï¼Ÿæ­¤ç‚ºé«˜é¢¨éšªé …ç›®ã€‚", tag: "High Risk", tagClass: "tag-high-risk", icon: "fa-solid fa-ban", btnText: "è¯ç¹«æ³•å‹™", btnLink: "mailto:legal@anymindgroup.com", btnStyle: "btn-outline", riskLevel: "high", category: "AnyCreator", roles: ['BD', 'IM'], hidden: true }
        ];

        let currentRole = 'All';
        let searchDebounce = null; 

        function filterRole(role) {
            currentRole = role;
            document.querySelectorAll('#quick-access-container + .grid-4, #dashboard .tab-btn').forEach(el => { 
                if(el.classList.contains('tab-btn')) {
                     el.classList.remove('active');
                     if(el.innerText.includes(role === 'All' ? 'å…¨éƒ¨' : role)) el.classList.add('active');
                }
            });
            document.querySelectorAll('#dashboard .tab-btn').forEach(btn => {
                 btn.classList.remove('active');
                 if(btn.innerText.includes(role === 'All' ? 'å…¨éƒ¨' : role)) btn.classList.add('active');
            });
            renderCards();
            sendToSheet("Switch_Tab", role, "User switched view");
        }

        function renderCards() {
            const container = document.getElementById('quick-access-container');
            container.innerHTML = ''; 
            knowledgeBase.forEach(item => {
                if (item.hidden) return; 
                if (currentRole === 'All' || item.roles.includes(currentRole)) {
                    let actionHtml = item.customHtml || `<a href="${item.btnLink}" target="_blank" class="${item.btnStyle}" onclick="logDecision('${item.id}', '${item.title}')">${item.btnText}</a>`;
                    const cardHTML = `<div class="card"><div class="card-icon"><i class="${item.icon}"></i></div><span class="tag ${item.tagClass}">${item.tag}</span><h3>${item.title}</h3><p>${item.desc}</p>${actionHtml}</div>`;
                    container.innerHTML += cardHTML;
                }
            });
        }

        function openModal(id) { document.getElementById(id).style.display = "flex"; }
        function openEditor() {
            const password = prompt("è«‹è¼¸å…¥ç®¡ç†å“¡å¯†ç¢¼ï¼š");
            if (password === "AnyTagAdmin") { 
                openModal('postEditorModal');
                document.getElementById('postDate').valueAsDate = new Date();
                if(document.getElementById('richEditor').innerHTML.trim() === '') document.getElementById('richEditor').innerHTML = '<p>è«‹åœ¨æ­¤è¼¸å…¥å…§å®¹...</p>';
            } else if (password !== null) { alert("å¯†ç¢¼éŒ¯èª¤ï¼Œç„¡æ³•å­˜å–ã€‚"); }
        }
        function closeModal(id) { document.getElementById(id).style.display = "none"; }
        window.onclick = function(event) { if (event.target.classList.contains('modal')) event.target.style.display = "none"; }

        let savedRange = null;
        function saveSelection() {
            const sel = window.getSelection();
            if (sel.getRangeAt && sel.rangeCount) savedRange = sel.getRangeAt(0);
        }
        function restoreSelection() {
            if (savedRange) {
                const sel = window.getSelection();
                sel.removeAllRanges();
                sel.addRange(savedRange);
            }
        }
        function formatDoc(cmd, value=null) {
            document.execCommand(cmd, false, value);
            const editor = document.getElementById('richEditor');
            editor.focus();
        }
        function addLink() {
            const url = prompt('è«‹è¼¸å…¥é€£çµç¶²å€ï¼š', 'https://');
            if (url) formatDoc('createLink', url);
        }
        
        function addImage() {
            let url = prompt('è«‹è¼¸å…¥åœ–ç‰‡ç¶²å€ (æ”¯æ´ Google Drive åˆ†äº«é€£çµï¼Œè«‹ç›´æ¥è¤‡è£½åˆ†äº«é€£çµè²¼ä¸Š)ï¼š', 'https://');
            if (url) {
                if (url.includes('drive-viewer')) {
                    alert("âš ï¸ è«‹å‹¿ä½¿ç”¨ drive-viewer ç¶²å€ï¼\né€™åªæ˜¯é è¦½é€£çµï¼Œç„¡æ³•å…¬é–‹é¡¯ç¤ºã€‚\n\nè«‹å›åˆ° Google Driveï¼Œå°åœ–ç‰‡æŒ‰å³éµ -> å…±ç”¨ -> è¤‡è£½é€£çµ (é€£çµé€šå¸¸åŒ…å« /file/d/...)");
                    return;
                }
                
                if (url.includes('drive.google.com')) {
                    const idMatch = url.match(/\/d\/([a-zA-Z0-9_-]+)/) || url.match(/id=([a-zA-Z0-9_-]+)/);
                    if (idMatch) {
                        url = `https://drive.google.com/thumbnail?id=${idMatch[1]}&sz=w1000`;
                    }
                }
                formatDoc('insertImage', url);
            }
        }

        function copyRowForSheet() {
            const date = document.getElementById('postDate').value;
            const version = document.getElementById('postVersion').value;
            const title = document.getElementById('postTitle').value;
            const tags = document.getElementById('postTags').value;
            let content = document.getElementById('richEditor').innerHTML;
            const status = document.getElementById('postStatus').value;
            const role = document.getElementById('postRole').value;

            if (!title.trim()) { alert("âŒ è«‹å¡«å¯«ã€Œæ¨™é¡Œ (Title)ã€ï¼å¦å‰‡æ—¥èªŒç„¡æ³•é¡¯ç¤ºã€‚"); return; }

            const cleanContent = content.replace(/(\r\n|\n|\r)/gm, "");
            const rowString = `${date}\t${version}\t${title}\t${tags}\t${cleanContent}\t${status}\t${role}`;

            navigator.clipboard.writeText(rowString).then(() => {
                alert("âœ… å·²è¤‡è£½æ•´åˆ—è³‡æ–™ï¼\nè«‹ç›´æ¥å» Google Sheet çš„ A æ¬„ (Date) æŒ‰ä¸‹ Ctrl+V è²¼ä¸Šå³å¯ã€‚");
            });
        }

        function logDecision(id, title) {
            const timestamp = new Date().toISOString();
            console.log(`[Log] Time: ${timestamp} | User Clicked: ${title} (ID: ${id})`);
            sendToSheet("Click", title, `ID: ${id}`);
        }

        function sendToSheet(action, label, detail) {
             // é€™è£¡ä¿ç•™ç©ºå‡½å¼æˆ–æ‚¨åŸæœ¬çš„å¯¦ä½œï¼Œå› ç‚ºä¸Šæ–¹ script URL æ˜¯ placeholder
             if(LOGGER_URL === "YOUR_PERSONAL_SCRIPT_URL_HERE") {
                 console.log("Mock logging:", action, label, detail);
                 return;
             }
             fetch(LOGGER_URL, {
                method: "POST",
                mode: "no-cors",
                headers: { "Content-Type": "text/plain" },
                body: JSON.stringify({ action, label, detail, user: "Unknown" })
            }).catch(e => console.error("Log failed", e));
        }

        function smartSearch() {
            if (searchDebounce) clearTimeout(searchDebounce);
            let input = document.getElementById('searchInput').value.toLowerCase();
            const container = document.getElementById('quick-access-container');
            container.innerHTML = ''; 
            let hasResult = knowledgeBase.length > 0;
            
            let foundCount = 0;
            knowledgeBase.forEach(item => {
                if (item.title.toLowerCase().includes(input) || item.desc.toLowerCase().includes(input) || item.tag.toLowerCase().includes(input) || (item.keywords && item.keywords.toLowerCase().includes(input))) {
                    foundCount++;
                    let alertHtml = item.riskLevel === 'high' ? `<div style="color:red; font-size:12px; margin-bottom:5px;"><i class="fa-solid fa-triangle-exclamation"></i> æ³¨æ„ï¼šæ­¤ç‚ºé«˜é¢¨éšªæ“ä½œ</div>` : '';
                    if (item.riskLevel === 'high') sendToSheet("Risk_Alert", input, `Triggered by: ${item.title}`);
                    let actionHtml = item.customHtml || `<a href="${item.btnLink}" target="_blank" class="${item.btnStyle}" onclick="logDecision('${item.id}', '${item.title}')">${item.btnText}</a>`;
                    const cardHTML = `<div class="card" style="border: ${item.riskLevel === 'high' ? '1px solid red' : ''}"><div class="card-icon"><i class="${item.icon}"></i></div><span class="tag ${item.tagClass}">${item.tag}</span>${alertHtml}<h3>${item.title}</h3><p>${item.desc}</p>${actionHtml}</div>`;
                    container.innerHTML += cardHTML;
                }
            });
            
            if (foundCount === 0) {
                container.innerHTML = `<div style="grid-column: 1/-1; text-align:center; color:#888; padding:20px;">æ‰¾ä¸åˆ°ç›¸é—œçµæœï¼Œè«‹å˜—è©¦æœå°‹ã€ŒSOPã€æˆ–ã€Œæ•¸æ“šã€ã€‚</div>`;
                if(input.length > 1) { searchDebounce = setTimeout(() => { sendToSheet("Search_Failed", input, "No Result Found"); }, 2000); }
            }
        }

        function showPage(pageId, navElement) {
            window.scrollTo(0, 0);
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            const targetSection = document.getElementById(pageId);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            if(navElement) navElement.classList.add('active');
            const map = {
                'dashboard': ['AnyTag/AnyCreator Support Hub', 'Welcomeï¼é‡åˆ°AnyTag/AnyCreatorçš„ç–‘é›£é›œç—‡äº†å—ï¼Ÿæˆ‘ä¾†å¹«ä½ è§£æ±ºï¼'], 
                'updates': ['ç”¢å“æ›´æ–°å‹•æ…‹', 'AnyTag / AnyCreator ç”¢å“æ›´æ–°æ—¥èªŒ'], 
                'anytag': ['AnyTag Guide', 'å¹³å°æ ¸å¿ƒåŠŸèƒ½èªªæ˜'],
                'anycreator': ['AnyCreator', 'å‰µä½œè€…ç«¯åŠŸèƒ½'],
                'troubleshoot': ['Troubleshooting', 'å¸¸è¦‹å•é¡Œæ’è§£'],
                'resources': ['Resources', 'è³‡æºä¸­å¿ƒ']
            };
            if(map[pageId]) {
                document.getElementById('header-title').innerText = map[pageId][0];
                document.getElementById('header-desc').innerText = map[pageId][1];
            }
        }
        
        function toggleSubmenu(menuId, element) {
            const submenu = document.getElementById(menuId);
            const isActive = submenu.classList.contains('open');
            
            if (!isActive) {
                submenu.classList.add('open');
                element.classList.add('expanded');
            } else {
                submenu.classList.remove('open');
                element.classList.remove('expanded');
            }
        }

        function startNoticeCarousel() {
            let noticeIndex = 0;
            const noticeBox = document.getElementById('notice-box');
            if (!noticeBox) return; 
            
            const notices = [
                "<span class='notice-date'>2025.11æœˆ</span> Threadsæ“´å……æ›´æ–°ï¼å¯æŠ“å–100ç¯‡è²¼æ–‡å”åŠ©ææ¡ˆåˆ†æã€‚",
                "<span class='notice-date'>2025.11æœˆ</span> AnyTagæ›´æ–°ï¼šEngagement report automationã€‚",
                "<span class='notice-date'>2025.11æœˆ</span> AnyCreatorå‰µä½œè€…é é¢æ›´æ–°ï¼Œæ–°å¢å„æ¡ˆä»¶ç‹€æ…‹ã€‚"
            ];
            noticeBox.innerHTML = `<div class="notice-text notice-active">${notices[0]}</div>`;

            function rotate() {
                const current = noticeBox.querySelector('.notice-text');
                if(current) {
                    current.classList.remove('notice-active');
                    current.classList.add('notice-hidden');
                }
                setTimeout(() => {
                    noticeIndex = (noticeIndex + 1) % notices.length;
                    noticeBox.innerHTML = `<div class="notice-text notice-hidden">${notices[noticeIndex]}</div>`;
                    setTimeout(() => {
                        const newText = noticeBox.querySelector('.notice-text');
                        newText.classList.remove('notice-hidden');
                        newText.classList.add('notice-active');
                    }, 50);
                }, 500);
            }
            setInterval(rotate, 4000);
        }
    </script>
</body>
</html>
